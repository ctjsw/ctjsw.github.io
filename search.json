[{"title":"BUSCO安装遇到的坑","url":"https://ctjsw.github.io/2019/08/08/BUSCO安装坑/","content":"<p>首先是了解conda的多环境功能：顺便补习下bioconda部署:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda config --add channels rconda config --add channels defaults </span><br><span class=\"line\"><span class=\"meta\">#</span> conda环境默认仅装了这一个channel</span><br><span class=\"line\">conda config --add channels</span><br><span class=\"line\">conda-forgeconda config --add channels bioconda</span><br><span class=\"line\">conda config --remove channels </span><br><span class=\"line\">conda list</span><br></pre></td></tr></table></figure>\n\n<p>另外，conda还有upgrade和search比较常用。其它的可以直接在终端输入conda查看。</p>\n<p>##设置一个新环境</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda info --envsconda create -c bioconda busco -n buscosource activate busco</span><br></pre></td></tr></table></figure>\n\n<p>除了以上简单的安装外，还可以建立工作空间将几个相应的软件装到一起，例如我想将几种比对的软件装在一个叫做aligners的环境下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">conda create -n aligners bwa bowtie hisat2</span><br></pre></td></tr></table></figure>\n\n<p>注：如果系统中已经安装了该软件，conda不会再进行安装</p>\n<p>这种分组安装的办法将软件安装在$HOME/miniconda2/envs/aligners/bin/目录下（其中aligners即conda create -n选项指定的环境名）</p>\n<p>用时需指定路径，例如想用aligners中的hisat2需要</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">如果想卸载某软件(例如刚才安装的star)，可以使用</span><br><span class=\"line\"></span><br><span class=\"line\">```conda uninstall star</span><br></pre></td></tr></table></figure>\n\n<p>或<figure class=\"highlight plain\"><figcaption><span>remove star```</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">\\# 注意：conda不会卸载系统中原来安装的软件，它只会卸载~/miniconda2/bin/目录中的软件，所以可以放心使用</span><br><span class=\"line\"></span><br><span class=\"line\">本次安装BUSCO遇到的问题</span><br><span class=\"line\"></span><br><span class=\"line\">```shell</span><br><span class=\"line\">/mnt/a/biosoft/minoconda/envs/busco/share/busco-3.0.2-7/config.ini.default</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> source activate busco$ find /mnt/a/biosoft/miniconda/ennv -name config.ini.default </span><br><span class=\"line\"><span class=\"meta\">$</span> cp  config.ini.default config.ini</span><br><span class=\"line\"><span class=\"meta\">$</span> vim config.ini</span><br><span class=\"line\"><span class=\"meta\">#</span>################[tblastn]/mnt/a/biosoft/minoconda/envs/busco/bin/tblastn[makeblastdb]/mnt/a/biosoft/minoconda/envs/busco/bin/makeblastdb[augustus]/mnt/a/biosoft/minoconda/envs/busco/bin/augustus[etraining]/mnt/a/biosoft/minoconda/envs/busco/bin/etraining[gff2gbSmallDNA.pl]/mnt/a/biosoft/minoconda/envs/busco/bin/gff2gbSmallDNA.pl[new_species.pl]/mnt/a/biosoft/minoconda/envs/busco/bin/new_species.pl[optimize_augustus.pl]/mnt/a/biosoft/minoconda/envs/busco/bin/optimize_augustus.pl[hmmsearch]/mnt/a/biosoft/minoconda/envs/busco/bin/hmmsearch[Rscript]/mnt/a/biosoft/minoconda/envs/busco/bin/Rscript###################$ cd ~$ vim .bashrc ###################export PATH=\"/path/to/AUGUSTUS/augustus-3.2.3/bin:$PATH\"export PATH=\"/path/to/AUGUSTUS/augustus-3.2.3/scripts:$PATH\"export AUGUSTUS_CONFIG_PATH=\"/path/to/AUGUSTUS/augustus-3.2.3/config/\"###################$ source ~/.bashrc$ printenv  </span><br><span class=\"line\"><span class=\"meta\">#</span>##check the env</span><br></pre></td></tr></table></figure>\n\n<p>运行时可能还存在链接库无法找寻以至于程序出错，解决方法就是将相对应或着接近的库拷贝或软链接到<code>~/miniconda3/env/busco/lib/</code>下。</p>\n<p>还需要下载<a href=\"https://link.jianshu.com/?t=http%3A%2F%2Fbusco.ezlab.org%2F\" target=\"_blank\" rel=\"noopener\">http://busco.ezlab.org/</a> 物种数据集</p>\n<p>Usage：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">((busco) ctj@DESKTOP-8MPSFK0:~$ python /mnt/a/biosoft//minoconda/envs/busco/bin/run_BUSCO.py --inusage: python BUSCO.py -i [SEQUENCE_FILE] -l [LINEAGE] -o [OUTPUT_NAME] -m [MODE][OTHER OPTIONS]run_BUSCO.py: error: argument -i/--in: expected one argument</span><br></pre></td></tr></table></figure>\n\n<p>Example:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(busco) ctj@DESKTOP-8MPSFK0:/mnt/a/biosoft$ python /mnt/a/biosoft//minoconda/envs/busco/bin/run_BUSCO.py -i /mnt/a/biosoft/GCF_000350225.1_ASM35022v2_genomic.fa -o result -l /mnt/a/biosoft/minoconda/envs/busco/lib/eukaryota_odb9 -m genome -f</span><br></pre></td></tr></table></figure>\n\n","categories":[],"tags":["软件使用"]},{"title":"ViroBlast","url":"https://ctjsw.github.io/2019/08/06/ViroBlast/","content":"<p>利用腾讯云服务搭建blast服务</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>1 安装必要的软件</span><br><span class=\"line\">sudo apt-get ncbi-blast+ apache2 libapache2-mod-php php php-gd</span><br><span class=\"line\"><span class=\"meta\">#</span>2 下载 viroblast</span><br><span class=\"line\">wget http://indra.mullins.microbiol.washington.edu/viroblast/download.php?ID=viroblast.tar.gz</span><br><span class=\"line\"><span class=\"meta\">#</span>3 解压后移动到apache www/html目录下</span><br><span class=\"line\"><span class=\"meta\">$</span> mv viroblast /var/www/html/</span><br><span class=\"line\"><span class=\"meta\">#</span>4 修改配置文件/var/www/html/viroblast/viroblast.ini</span><br><span class=\"line\">blast+: /usr/bin</span><br><span class=\"line\">blastn: test_na_db =&gt; Nucleotide test database</span><br><span class=\"line\">blastp: test_aa_db =&gt; Protein test database #(, .* =&gt; Tair10 ##逗号分隔多个数据库，右为网页端展示的名称) </span><br><span class=\"line\">blastx: test_aa_db =&gt; Protein test database</span><br><span class=\"line\">tblastn: test_na_db =&gt; Nucleotide test database</span><br><span class=\"line\">tblastx: test_na_db =&gt; Nucleotide test database</span><br><span class=\"line\"><span class=\"meta\">#</span>5 blastdb 默认在/var/www/html/viroblast/db目录下</span><br><span class=\"line\"><span class=\"meta\">$</span> makeblastdb -in *.fasta -out .* -dbtype prot/nucl</span><br><span class=\"line\"><span class=\"meta\">#</span>6 登录 ip/viroblast/viroblast.php 即可使用</span><br><span class=\"line\">*ip*/viroblast/viroblast.php</span><br></pre></td></tr></table></figure>\n\n<p>使用Apache2 rewrite功能重定向主页</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>1 需要在apache2   /etc/apache2/sites-available/目录下修改000-default.conf</span><br><span class=\"line\">sudo vim /etc/apache2/sites-available/000-default.conf</span><br><span class=\"line\"><span class=\"meta\">#</span>2 在&lt;/virtual&gt;前添加</span><br><span class=\"line\">1 RewriteEngine on</span><br><span class=\"line\">2    RewriteCond  %&#123;REQUEST_URI&#125; ^/$</span><br><span class=\"line\">3   RewriteRule  (.*) *ip*/viroblast/ [L,R=301]</span><br><span class=\"line\"><span class=\"meta\">#</span>3 启动rewrite功能并重启apache2</span><br><span class=\"line\">sudo a2enmod rewrite</span><br><span class=\"line\">sudo service apache2 restart</span><br></pre></td></tr></table></figure>\n\n<p>sequenceserver(未完成passenger -apache2配置，待更新)</p>\n<p>界面更为美观的blast网页应用</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>1 安装必须ruby基础包</span><br><span class=\"line\">sudo apt-get install ruby gem ruby-dev ncbi-blast+         </span><br><span class=\"line\"><span class=\"meta\">#</span>2 使用gem安装sequenceserver</span><br><span class=\"line\">sudo gem install sequenceserver </span><br><span class=\"line\"><span class=\"meta\">#</span>3 运行sequenceserver </span><br><span class=\"line\">sequenceserver -d /db目录</span><br><span class=\"line\"><span class=\"meta\">#</span>4</span><br></pre></td></tr></table></figure>\n\n","categories":[],"tags":["软件使用"]},{"title":"project","url":"https://ctjsw.github.io/project/index.html","content":"","categories":[],"tags":[]},{"title":"about","url":"https://ctjsw.github.io/about/index.html","content":"","categories":[],"tags":[]},{"title":"category","url":"https://ctjsw.github.io/category/index.html","content":"","categories":[],"tags":[]},{"title":"tag","url":"https://ctjsw.github.io/tag/index.html","content":"","categories":[],"tags":[]},{"title":"search","url":"https://ctjsw.github.io/search/index.html","content":"","categories":[],"tags":[]}]